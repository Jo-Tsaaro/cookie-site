<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exhibition Visitor Consent</title>

    <!-- Google Material Icons -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <img
        src="https://media.umbraco.io/dwtc-new/vo1hqciy/dec-bilingual-logo.png"
        alt="DWTC Logo"
        class="logo"
      />

      <h2>Confirm Your Consent</h2>
      <p>
        We value your privacy. By providing consent, you allow us to collect and
        process your personal data for exhibition-related communications,
        updates, and future event invitations. View our
        <span class="open-pdf">Privacy Policy</span>
        for details.
      </p>

      <form id="visitorForm" method="post">
        <label for="email">Email Address</label>
        <p class="helper-text">
          <span class="material-icons info-icon">info</span>
          This email will be used to send you event updates and relevant
          information.
        </p>

        <input
          type="email"
          id="email"
          name="email"
          placeholder="Enter your email"
          required
          autocomplete="email"
        />

        <label>Choose Your Preference</label>
        <div class="radio-group">
          <label class="radio-inline">
            <input
              type="radio"
              id="accept"
              name="consent"
              value="accept"
              required
            />
            <span
              ><strong>Accept</strong> – I agree to the collection and use of my
              data for exhibition-related purposes.</span
            >
          </label>

          <label class="radio-inline">
            <input type="radio" id="decline" name="consent" value="decline" />
            <span><strong>Decline</strong> – I do not agree.</span>
          </label>
        </div>

        <button type="submit" id="submitBtn" disabled>
          Continue to Visitor Registration
        </button>
      </form>
    </div>

    <!-- Decline Modal -->
    <div id="declineModal" class="alert-modal" role="dialog" aria-modal="true">
      <div class="alert-content">
        <span
          class="material-icons close-icon"
          role="button"
          aria-label="Close modal"
          >close</span
        >
        <span class="material-icons alert-icon" aria-hidden="true"
          >warning</span
        >
        <h3>Consent Required</h3>
        <p>
          We respect your privacy choices. Without your consent, we are unable
          to register you for the exhibition or provide event updates.<br /><br />
          To continue, please review our privacy policy and confirm acceptance
          of our data processing terms.
        </p>
      </div>
    </div>

    <!-- PDF Modal -->
    <div id="pdfModal" class="modal" role="dialog" aria-modal="true">
      <div class="modal-content">
        <span class="close">&times;</span>
        <iframe id="pdfViewer" src="" frameborder="0"></iframe>
      </div>
    </div>

    <!-- Modal & Form Scripts -->
    <script>
      const acceptRadio = document.getElementById("accept");
      const declineRadio = document.getElementById("decline");
      const submitBtn = document.getElementById("submitBtn");
      const declineModal = document.getElementById("declineModal");
      const closeDecline = document.querySelector(".close-icon");

      const toggleButtonState = () => {
        submitBtn.disabled = !(acceptRadio.checked || declineRadio.checked);
      };

      acceptRadio.addEventListener("change", toggleButtonState);
      declineRadio.addEventListener("change", toggleButtonState);

      document
        .getElementById("visitorForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const selectedConsent = document.querySelector(
            'input[name="consent"]:checked'
          );
          if (!selectedConsent) return;

          if (selectedConsent.value === "decline") {
            declineModal.style.display = "block";
          } else {
            window.location.href =
              "https://www.dubaiexhibitioncentre.com/en/visit";
          }
        });

      closeDecline.addEventListener("click", () => {
        declineModal.style.display = "none";
      });

      // PDF Modal Logic
      const modal = document.getElementById("pdfModal");
      const closeBtn = document.querySelector(".close");
      const iframe = document.getElementById("pdfViewer");
      const openPdfSpan = document.querySelector(".open-pdf");

      openPdfSpan.addEventListener("click", function () {
        iframe.src =
          "https://privacy-central5.securiti.ai/notice-embed/cb808e6c-54a1-47e5-8b08-53c71dbc33bf";
        modal.style.display = "block";
      });

      closeBtn.addEventListener("click", function () {
        modal.style.display = "none";
        iframe.src = "";
      });

      window.addEventListener("click", function (e) {
        if (e.target === modal) {
          modal.style.display = "none";
          iframe.src = "";
        }
      });
    </script>
    <!-- Securiti SDK -->
    <script src="https://cdn-app5.securiti.ai/consent/form-consent-sdk.js"></script>
<script>
  window.addEventListener("load", function () {
    FormConsentSDK.initialize({
      codeGenMetadata: {
        formPropertyId: "2",
        formSelector: '[id*="visitorForm"]',
        subjectIdentifiers: [
          {
            name: "Email Address",
            selector: '[name = "email"]',
            isPrimary: true,
          },
        ],
        consentIdentifiers: [
          {
            type: "radio",
            name: "consent",
            selector: '[name = "consent"]',
            propertyId: 18110,
            consentValue: "accept",
          },
        ],
        consentTrigger: { action: "click", selector: '[id = "submitBtn"]' },
      },
      url: "https://app5.securiti.ai/privaci/v1/",
      authToken: "32c9c281-7428-427e-bab7-183bdfebc9d5",
      orgId: "1",
      onConsentSuccess: null,
      onConsentFailure: null,
    });
  });
</script>
  </body>
</html>
